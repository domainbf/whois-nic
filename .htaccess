Options -Indexes

RewriteEngine On

# 强制 HTTPS（可选，根据需要取消注释）
# RewriteCond %{HTTP:X-Forwarded-Proto} !https
# RewriteCond %{HTTPS} off
# RewriteCond %{HTTP:CF-Visitor} !{"scheme":"https"}
# RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# 基础路由
RewriteRule ^$ index.php [L]
RewriteRule ^api/?$ index.php?json=1 [L,QSA]
RewriteRule ^login/?$ login.php [L]
RewriteRule ^manifest/?$ manifest.php [L]

# 域名查询规则 - 支持 /example.com 和 /example.com/ 格式
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+)/?$ index.php?domain=$1 [L,QSA]

# 其他参数查询支持
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/(api|login|manifest)/
RewriteRule ^(.*)$ index.php [L,QSA]
